{
    "version": "2102.03",
    "license": "OFL-1.1",
    "homepage": "https://github.com/microsoft/cascadia-code",
    "url": "https://github.com/microsoft/cascadia-code/releases/download/v2102.03/CascadiaCode-2102.03.zip",
    "hash": "6c96e5ffab9dbe0802a232bf5cb3c8538ee22a10e70c7897a3b3924a4b1b2e36",
    "depends": "pswinglue",
    "installer": {
        "script": [
            "if(!(is_admin)) { error \"Admin rights are required.\"; exit 1 }",
            "$paths = Get-ChildItem -LiteralPath $dir -Recurse -File |",
            "Where-Object Name -Match '\\.(otf|ttf)$' |",
            "Select-Object -ExpandProperty FullName",
            "if ($paths -match '\\.otf$') {",
            "  $paths = $paths | Where-Object { $_ -match '\\.otf$' }",
            "}",
            "$paths | ForEach-Object {",
            "  PSWinGlue\\Install-Font -Path $_ -Scope System -WarningAction SilentlyContinue -ErrorAction SilentlyContinue",
            "}"
        ]
    },
    "uninstaller": {
        "script": [
            "if(!(is_admin)) { error \"Admin rights are required.\"; exit 1 }",
            "$uninstallFontFileRegex = (Get-ChildItem -LiteralPath $dir -Recurse -File |",
            "  Where-Object Name -Match '\\.(otf|ttf)$' |",
            "  Select-Object -ExpandProperty BaseName) -join '|'",
            "",
            "Get-Fonts -WarningAction SilentlyContinue |",
            "Where-Object { $_.File.Name -match $uninstallFontFileRegex } |",
            "Select-Object -ExpandProperty Name |",
            "ForEach-Object { PSWinGlue\\Uninstall-Font -Name $_ -Scope System }"
        ]
    },
    "checkver": "github",
    "autoupdate": {
        "url": "https://github.com/microsoft/cascadia-code/releases/download/v$version/CascadiaCode-$version.zip"
    }
}
